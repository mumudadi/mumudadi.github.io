"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function empty(e){return void 0===e||null==e||""==e}function getRandText(e){return Array.isArray(e)?e[Math.floor(Math.random()*e.length+1)-1]:e}function showMessage(e,t,i){!i&&""!==sessionStorage.getItem("waifu-text")&&null!==sessionStorage.getItem("waifu-text")||(Array.isArray(e)&&(e=e[Math.floor(Math.random()*e.length+1)-1]),live2d_settings.showF12Message&&console.log("[Message]",e.replace(/<[^<>]+>/g,"")),i&&sessionStorage.setItem("waifu-text",e),$(".waifu-tips").stop(),$(".waifu-tips").html(e).fadeTo(200,1),void 0===t&&(t=5e3),hideMessage(t))}function hideMessage(e){$(".waifu-tips").stop().css("opacity",1),void 0===e&&(e=5e3),window.setTimeout(function(){sessionStorage.removeItem("waifu-text")},e),$(".waifu-tips").delay(e).fadeTo(200,0)}function initModel(e,t){"function"!=typeof $.ajax&&("function"==typeof jQuery.ajax?window.$=jQuery:console.log("[Error] JQuery is not defined.")),live2d_settings.waifuSize=live2d_settings.waifuSize.split("x"),live2d_settings.waifuTipsSize=live2d_settings.waifuTipsSize.split("x"),live2d_settings.waifuEdgeSide=live2d_settings.waifuEdgeSide.split(":"),$("#live2d").attr("width",live2d_settings.waifuSize[0]),$("#live2d").attr("height",live2d_settings.waifuSize[1]),$(".waifu-tips").width(live2d_settings.waifuTipsSize[0]),$(".waifu-tips").height(live2d_settings.waifuTipsSize[1]),$(".waifu-tips").css("top",live2d_settings.waifuToolTop),$(".waifu-tips").css("font-size",live2d_settings.waifuFontSize),$(".waifu-tool").css("font-size",live2d_settings.waifuToolFont),$(".waifu-tool span").css("line-height",live2d_settings.waifuToolLine),"left"==live2d_settings.waifuEdgeSide[0]?$(".waifu").css("left",live2d_settings.waifuEdgeSide[1]+"px"):"right"==live2d_settings.waifuEdgeSide[0]&&$(".waifu").css("right",live2d_settings.waifuEdgeSide[1]+"px"),window.waifuResize=function(){$(window).width()<=Number(live2d_settings.waifuMinWidth.replace("px",""))?$(".waifu").hide():$(".waifu").show()},"disable"!=live2d_settings.waifuMinWidth&&(waifuResize(),$(window).resize(function(){waifuResize()}));try{"axis-x"==live2d_settings.waifuDraggable?$(".waifu").draggable({axis:"x",revert:live2d_settings.waifuDraggableRevert}):"unlimited"==live2d_settings.waifuDraggable?$(".waifu").draggable({revert:live2d_settings.waifuDraggableRevert}):$(".waifu").css("transition","all .3s ease-in-out")}catch(e){console.log("[Error] JQuery UI is not defined.")}live2d_settings.homePageUrl="auto"==live2d_settings.homePageUrl?window.location.protocol+"//"+window.location.hostname+"/":live2d_settings.homePageUrl,"file:"==window.location.protocol&&"//"==live2d_settings.modelAPI.substr(0,2)&&(live2d_settings.modelAPI="http:"+live2d_settings.modelAPI),$(".waifu-tool .fui-home").click(function(){window.location=live2d_settings.homePageUrl}),$(".waifu-tool .fui-info-circle").click(function(){window.open(live2d_settings.aboutPageUrl)}),"object"==(void 0===e?"undefined":_typeof(e))?loadTipsMessage(e):$.ajax({cache:!0,url:""==e?live2d_settings.tipsMessage:"waifu-tips.json"==e.substr(e.length-15)?e:e+"waifu-tips.json",dataType:"json",success:function(e){loadTipsMessage(e)}}),live2d_settings.showToolMenu||$(".waifu-tool").hide(),live2d_settings.canCloseLive2d||$(".waifu-tool .fui-cross").hide(),live2d_settings.canSwitchModel||$(".waifu-tool .fui-eye").hide(),live2d_settings.canSwitchTextures||$(".waifu-tool .fui-user").hide(),live2d_settings.canSwitchHitokoto||$(".waifu-tool .fui-chat").hide(),live2d_settings.canTakeScreenshot||$(".waifu-tool .fui-photo").hide(),live2d_settings.canTurnToHomePage||$(".waifu-tool .fui-home").hide(),live2d_settings.canTurnToAboutPage||$(".waifu-tool .fui-info-circle").hide(),void 0===e&&(e="");var i=localStorage.getItem("modelId"),s=localStorage.getItem("modelTexturesId");if(!live2d_settings.modelStorage||null==i)i=live2d_settings.modelId,s=live2d_settings.modelTexturesId;loadModel(i,s)}function loadModel(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=Math.floor(88*Math.random());loadlive2d("live2d","https://cdn.jsdelivr.net/gh/mumudadi/live2dw@latest/assets/live2d-widget-model-Pio/assets/"+i+".json",live2d_settings.showF12Status?console.log("[Status]","live2d","模型",e+"-"+t,"加载完成"):null)}function whichButton(e){2==e.button&&showMessage(getRandText(window.waifu_tips.waifu.right_click),5e3,!0)}function loadTipsMessage(e){if(window.waifu_tips=e,$.each(e.mouseover,function(e,t){$(document).on("mouseover",t.selector,function(){var e=getRandText(t.text);showMessage(e=e.render({text:$(this).text()}),3e3)})}),$.each(e.click,function(e,t){$(document).on("click",t.selector,function(){var e=getRandText(t.text);showMessage(e=e.render({text:$(this).text()}),3e3,!0)})}),$.each(e.seasons,function(e,t){var i=new Date,s=t.date.split("-")[0],o=t.date.split("-")[1]||s;if(s.split("/")[0]<=i.getMonth()+1&&i.getMonth()+1<=o.split("/")[0]&&s.split("/")[1]<=i.getDate()&&i.getDate()<=o.split("/")[1]){var n=getRandText(t.text);showMessage(n=n.render({year:i.getFullYear()}),6e3,!0)}}),live2d_settings.showF12OpenMsg){var t=function(){};console.log("%c",t),t.toString=function(){showMessage(getRandText(e.waifu.console_open_msg),5e3,!0)}}live2d_settings.showCopyMessage&&$(document).on("copy",function(){showMessage(getRandText(e.waifu.copy_message),5e3,!0)}),$(".waifu-tool .fui-photo").click(function(){showMessage(getRandText(e.waifu.screenshot_message),5e3,!0),window.Live2D.captureName=live2d_settings.screenshotCaptureName,window.Live2D.captureFrame=!0}),$(".waifu-tool .fui-cross").click(function(){sessionStorage.setItem("waifu-dsiplay","none"),showMessage(getRandText(e.waifu.hidden_message),1300,!0),window.setTimeout(function(){$(".waifu").hide()},1300)}),window.showWelcomeMessage=function(e){var t;if(window.location.href==live2d_settings.homePageUrl){var i=(new Date).getHours();t=getRandText(23<i||i<=5?e.waifu.hour_tips["t23-5"]:5<i&&i<=7?e.waifu.hour_tips["t5-7"]:7<i&&i<=11?e.waifu.hour_tips["t7-11"]:11<i&&i<=14?e.waifu.hour_tips["t11-14"]:14<i&&i<=17?e.waifu.hour_tips["t14-17"]:17<i&&i<=19?e.waifu.hour_tips["t17-19"]:19<i&&i<=21?e.waifu.hour_tips["t19-21"]:21<i&&i<=23?e.waifu.hour_tips["t21-23"]:e.waifu.hour_tips.default)}else{var s=e.waifu.referrer_message;if(""!==document.referrer){var o=document.createElement("a");o.href=document.referrer;var n=o.hostname.split(".")[1];t=window.location.hostname==o.hostname?s.localhost[0]+document.title.split(s.localhost[2])[0]+s.localhost[1]:"baidu"==n?s.baidu[0]+o.search.split("&wd=")[1].split("&")[0]+s.baidu[1]:"so"==n?s.so[0]+o.search.split("&q=")[1].split("&")[0]+s.so[1]:"google"==n?s.google[0]+document.title.split(s.google[2])[0]+s.google[1]:($.each(e.waifu.referrer_hostname,function(e,t){e==o.hostname&&(o.hostname=getRandText(t))}),s.default[0]+o.hostname+s.default[1])}else t=s.none[0]+document.title.split(s.none[2])[0]+s.none[1]}showMessage(t,6e3)},live2d_settings.showWelcomeMessage&&showWelcomeMessage(e);var s=e.waifu;function o(e){return live2d_settings.modelStorage?localStorage.getItem(e):sessionStorage.getItem(e)}function i(){"visible"==$(document)[0].visibilityState&&n()}function n(){switch(live2d_settings.hitokotoAPI){case"lwl12.com":$.getJSON("https://api.lwl12.com/hitokoto/v1?encode=realjson",function(e){if(!empty(e.source)){var t=s.hitokoto_api_message["lwl12.com"][0];empty(e.author)||(t+=s.hitokoto_api_message["lwl12.com"][1]),t=t.render({source:e.source,creator:e.author}),window.setTimeout(function(){showMessage(t+s.hitokoto_api_message["lwl12.com"][2],3e3,!0)},5e3)}showMessage(e.text,5e3,!0)});break;case"fghrsh.net":$.getJSON("https://api.fghrsh.net/hitokoto/rand/?encode=jsc&uid=3335",function(e){if(!empty(e.source)){var t=s.hitokoto_api_message["fghrsh.net"][0];t=t.render({source:e.source,date:e.date}),window.setTimeout(function(){showMessage(t,3e3,!0)},5e3),showMessage(e.hitokoto,5e3,!0)}});break;case"jinrishici.com":$.ajax({url:"https://v2.jinrishici.com/one.json",xhrFields:{withCredentials:!0},success:function(e){if(!empty(e.data.origin.title)){var t=s.hitokoto_api_message["jinrishici.com"][0];t=t.render({title:e.data.origin.title,dynasty:e.data.origin.dynasty,author:e.data.origin.author}),window.setTimeout(function(){showMessage(t,3e3,!0)},5e3)}showMessage(e.data.content,5e3,!0)}});break;default:$.getJSON("https://v1.hitokoto.cn",function(e){if(!empty(e.from)){var t=s.hitokoto_api_message["hitokoto.cn"][0];t=t.render({source:e.from,creator:e.creator}),window.setTimeout(function(){showMessage(t,3e3,!0)},5e3)}showMessage(e.hitokoto,5e3,!0)})}}live2d_settings.showHitokoto&&(window.getActed=!1,window.hitokotoTimer=0,window.hitokotoInterval=!1,$(document).mousemove(function(e){getActed=!0}).keydown(function(){getActed=!0}),setInterval(function(){getActed?(getActed=hitokotoInterval=!1,window.clearInterval(hitokotoTimer)):hitokotoInterval||(hitokotoInterval=!0,hitokotoTimer=window.setInterval(i,3e4))},1e3)),$(".waifu-tool .fui-eye").click(function(){loadModel()}),$(".waifu-tool .fui-user").click(function(){var t,i,e;t=o("modelId"),i=o("modelTexturesId"),e=live2d_settings.modelTexturesRandMode,$.ajax({cache:"switch"==e,url:live2d_settings.modelAPI+e+"_textures/?id="+t+"-"+i,dataType:"json",success:function(e){1!=e.textures.id||1!=i&&0!=i?showMessage(s.load_rand_textures[1],3e3,!0):showMessage(s.load_rand_textures[0],3e3,!0),loadModel(t,e.textures.id)}})}),$(".waifu-tool .fui-chat").click(function(){n()})}window.live2d_settings=Array(),live2d_settings.modelAPI="//live2d.fghrsh.net/api/",live2d_settings.tipsMessage="waifu-tips.json",live2d_settings.hitokotoAPI="hitokoto.cn",live2d_settings.modelId=1,live2d_settings.modelTexturesId=53,live2d_settings.showToolMenu=!1,live2d_settings.canCloseLive2d=!0,live2d_settings.canSwitchModel=!0,live2d_settings.canSwitchTextures=!0,live2d_settings.canSwitchHitokoto=!0,live2d_settings.canTakeScreenshot=!0,live2d_settings.canTurnToHomePage=!0,live2d_settings.canTurnToAboutPage=!0,live2d_settings.modelStorage=!0,live2d_settings.modelRandMode="switch",live2d_settings.modelTexturesRandMode="rand",live2d_settings.showHitokoto=!0,live2d_settings.showF12Status=!0,live2d_settings.showF12Message=!1,live2d_settings.showF12OpenMsg=!0,live2d_settings.showCopyMessage=!0,live2d_settings.showWelcomeMessage=!0,live2d_settings.waifuSize="280x250",live2d_settings.waifuTipsSize="280xauto",live2d_settings.waifuFontSize="18px",live2d_settings.waifuToolFont="14px",live2d_settings.waifuToolLine="20px",live2d_settings.waifuToolTop="0px",live2d_settings.waifuMinWidth="768px",live2d_settings.waifuEdgeSide="left:0",live2d_settings.waifuDraggable="disable",live2d_settings.waifuDraggableRevert=!0,live2d_settings.l2dVersion="1.4.2",live2d_settings.l2dVerDate="2018.11.12",live2d_settings.homePageUrl="auto",live2d_settings.aboutPageUrl="https://mumudadi.top",live2d_settings.screenshotCaptureName="live2d.png",String.prototype.render=function(d){return this.replace(/(\\)?\{([^\{\}\\]+)(\\)?\}/g,function(e,t,i,s){if(t||s)return e.replace("\\","");var o,n,a=i.replace(/\s/g,"").split("."),l=d;for(o=0,n=a.length;o<n;++o)if(null==(l=l[a[o]]))return"";return l})};