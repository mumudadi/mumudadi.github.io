<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name="viewport"><title itemprop="name">Shiro安全框架使用 | 木木</title><link rel="shortcut icon" href="/images/favicon.ico"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+SerifMerriweather|Merriweather+Sans|Source+Code+Pro|Ubuntu:400,700|Noto+Serif+SC" media="all"><link rel="dns-prefetch" href="//cdn.jsdelivr.net"><link rel="stylesheet" id="saukra_css-css" href="/css/style.css" media="all"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/css/lib.min.css" media="all"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/css/font.css" media="all"><link rel="stylesheet" href="/css/insight.css" media="all"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/css/jquery.fancybox.min.css" media="all"><link rel="stylesheet" href="/css/zoom.css" media="all"><link rel="stylesheet" href="/css/sharejs.css"><script>var mashiro_option=new Object,mashiro_global=new Object;mashiro_option.NProgressON=!0,mashiro_option.email_domain="",mashiro_option.email_name="",mashiro_option.cookie_version_control="",mashiro_option.qzone_autocomplete=!1,mashiro_option.site_name="さくら荘の木木",mashiro_option.author_name="木木",mashiro_option.site_url="mumudadi.top",mashiro_option.v_appId="IMM34UkPXXl7Mt5n4RAXaYfH-gzGzoHsz",mashiro_option.v_appKey="5QWKOyJVR6WOwKDKvKfNsxH8",mashiro_option.mathjax="0",mashiro_option.qq_api_url="https://api.mashiro.top/qqinfo/",mashiro_option.qq_avatar_api_url="https://api.mashiro.top/qqinfo/"</script><script>var bg="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/cover/(1).jpg.webp,https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/cover/(2).jpg.webp,https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/cover/(3).jpg.webp,https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/cover/(4).jpg.webp,https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/cover/(5).jpg.webp,https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/cover/(6).jpg.webp,https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/cover/(7).jpg.webp,https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/cover/(8).jpg.webp,https://api.gymxbl.com/images/".split(","),bgindex=Math.floor(Math.random()*bg.length);(window.ActiveXObject||"ActiveXObject"in window)&&alert("朋友，IE浏览器未适配哦~")</script><style>.hljs-ln{border-collapse:collapse}.hljs-ln td{padding:0}.hljs-ln-n:before{content:attr(data-line-number)}</style><style>.site-top .lower nav{display:block!important}#pagination a:hover,.author-profile i,.float-content i:hover,.post-content a:hover,.post-like a,.post-more i:hover,.post-share .show-share,.sub-text,.we-info a,span.sitename{color:#fe9600}.ar-time i,.comment .comment-reply-link,.download,.feature i,.links ul li:before,.navigator i:hover,.object,.siren-checkbox-radio:checked+.siren-checkbox-radioInput:after,span.ar-circle{background:#fe9600}::-webkit-scrollbar-thumb{background:#fe9600}#pagination a:hover,.comment-respond input[type=submit]:hover,.download,.link-title,.links ul li:hover,.navigator i:hover{border-color:#fe9600}#archives-temp h3,#comments-navi a.next,#comments-navi a.prev,.comment h4 a,.comment h4 a:hover,.comment-respond input[type=submit]:hover,.entry-content a:hover,.entry-title a:hover,.site-info a:hover,.site-title a:hover,.site-top ul li a:hover,.sorry li a:hover,i.iconfont.js-toggle-search.iconsearch:hover,span.page-numbers.current{color:#fe9600}.comments .comments-main{display:block!important}.comments .comments-hidden{display:none!important}</style><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="木木" type="application/atom+xml"></head><body oncontextmenu="return!1" onmousedown="whichButton(event)" class="page-template page-template-user page-template-page-analytics page-template-userpage-analytics-php page page-id-1297 chinese-font serif isWebKit"><div class="scrollbar" id="bar"></div><a href="#" class="cd-top faa-float animated"></a><section id="main-container"><div class="headertop"><div id="banner_wave_1"></div><div id="banner_wave_2"></div><figure id="centerbg" class="centerbg"><div class="focusinfo no-select"><div class="header-tou"><a href="mumudadi.top"><img src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/custom/avatar.jpg"></a></div><div class="header-info"><p>做一只遇到BUG不口吐芬芳的程序猿</p><div class="top-social_v2"><li id="bg-pre"><img class="flipx" src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/other/next-b.svg"></li><li><a href="https://github.com/mumudadi" target="_blank" class="social-github" title="github"><img src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/social/github.png"></a></li><li><a href="https://github.com/mumudadi" target="_blank" class="social-github" title="sina"><img src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/social/sina.png"></a></li><li><a href="https://github.com/mumudadi" target="_blank" class="social-github" title="wangyiyun"><img src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/social/wangyiyun.png"></a></li><li><a href="https://github.com/mumudadi" target="_blank" class="social-github" title="zhihu"><img src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/social/zhihu.png"></a></li><li><a href="https://github.com/mumudadi" target="_blank" class="social-github" title="email"><img src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/social/email.svg"></a></li><li class="wechat"><a href="/#"><img src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/social/wechat.png"></a><div class="wechatInner"><img src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/custom/wechat.jpg"></div></li><li id="bg-next"><img src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/other/next-b.svg"></li></div></div></div></figure><div id="video-container"><video style="object-fit:fill" id="bgvideo" class="video" video-name="" src="" width="auto" preload="auto"></video><div id="video-btn" class="loadvideo videolive"></div><div id="video-add"></div><div class="video-stu"></div></div><div class="headertop-down faa-float animated" onclick="headertop_down()"><span><i class="fa fa-chevron-down" aria-hidden="true"></i></span></div></div><div id="page" class="site wrapper"><header class="site-header no-select gizle sabit" role="banner"><div class="site-top"><div class="site-branding"><span class="site-title"><span class="logolink moe-mashiro"><a href="/"><span class="sakurasono">さくら荘の</span> <span class="shironeko">木木</span></a></span></span></div><div class="searchbox search-form-submit"><i class="iconfont js-toggle-search iconsearch icon-search"></i></div><div id="show-nav" class="showNav mobile-fit"><div class="line line1"></div><div class="line line2"></div><div class="line line3"></div></div><div class="lower-cantiner"><div class="lower"><nav class="mobile-fit-control hide"><ul id="menu-new" class="menu"><li><a href="/"><span class="faa-parent animated-hover"><i class="fa fa-fort-awesome faa-shake" aria-hidden="true"></i> 首页</span></a></li><li><a href="/archives"><span class="faa-parent animated-hover"><i class="fa fa-archive faa-shake" aria-hidden="true"></i> 归档</span></a><ul class="sub-menu"><li><a href="/categories/%E6%8A%80%E6%9C%AF/"><i class="fa fa-code" aria-hidden="true"></i> 技术</a></li><li><a href="/categories/%E7%94%9F%E6%B4%BB/"><i class="fa fa-file-text-o" aria-hidden="true"></i> 生活</a></li><li><a href="/categories/%E8%B5%84%E6%BA%90/"><i class="fa fa-cloud-download" aria-hidden="true"></i> 资源</a></li><li><a href="/categories/%E9%9A%8F%E6%83%B3/"><i class="fa fa-commenting-o" aria-hidden="true"></i> 随想</a></li><li><a href="/categories/%E8%BD%AC%E8%BD%BD/"><i class="fa fa-book" aria-hidden="true"></i> 转载</a></li></ul></li><li><a href="javascript:;"><span class="faa-parent animated-hover"><i class="fa fa-list-ul faa-vertical" aria-hidden="true"></i> 清单</span></a><ul class="sub-menu"><li><a href="javascript:location.href+='home/';"><i class="fa fa-fort-awesome" aria-hidden="true"></i> 主页</a></li><li><a href="/backstage/"><i class="fa fa fa-meetup faa-pulse" aria-hidden="true"></i> 后台</a></li><li><a href="/cool/"><i class="fa fa fa-terminal" aria-hidden="true"></i> 炫酷</a></li><li><a href="/tags/%E6%82%A6%E8%AF%BB/"><i class="fa fa-th-list faa-bounce" aria-hidden="true"></i> 书单</a></li><li><a href="/bangumi/"><i class="fa fa-film faa-vertical" aria-hidden="true"></i> 番组</a></li><li><a href="/music/"><i class="fa fa-headphones" aria-hidden="true"></i> 歌单</a></li><li><a href="/tags/%E5%9B%BE%E9%9B%86/"><i class="fa fa-photo" aria-hidden="true"></i> 图集</a></li></ul></li><li><a href="/comment/"><span class="faa-parent animated-hover"><i class="fa fa-pencil-square-o faa-tada" aria-hidden="true"></i> 留言板</span></a></li><li><a href="/links/"><span class="faa-parent animated-hover"><i class="fa fa-link faa-shake" aria-hidden="true"></i> 友人帐</span></a></li><li><a href="/donate/"><span class="faa-parent animated-hover"><i class="fa fa-heart faa-pulse" aria-hidden="true"></i> 赞赏</span></a></li><li><a href="javascript:;"><span class="faa-parent animated-hover"><i class="fa fa-leaf faa-wrench" aria-hidden="true"></i> 关于</span></a><ul class="sub-menu"><li><a href="/about/"><i class="fa fa-meetup" aria-hidden="true"></i> 我？</a></li><li><a href="/theme-sakura/"><i class="fa iconfont icon-sakura" aria-hidden="true"></i> 主题</a></li><li><a href="/lab/"><i class="fa fa-cogs" aria-hidden="true"></i> Lab</a></li></ul></li><li><a href="/client/"><span class="faa-parent animated-hover"><i class="fa fa-android faa-vertical" aria-hidden="true"></i> 客户端</span></a></li><li><a href="/atom.xml"><span class="faa-parent animated-hover"><i class="fa fa-rss faa-pulse" aria-hidden="true"></i> RSS</span></a></li></ul></nav></div></div></div></header><link rel="stylesheet" href="/css/sharejs.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css"><div class="pattern-center-blank"></div><div class="pattern-center single-center"><div class="pattern-attachment-img lazyload" style="background-image:url(https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/anime/20.jpg)" src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/anime/20.jpg"></div><header class="pattern-header single-header"><h1 class="entry-title">Shiro安全框架使用</h1><p class="entry-census"><span><a href="mumudadi.top"><img src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/custom/avatar.jpg"></a></span><span><a href="mumudadi.top">木木</a></span> <span class="bull">·</span> 2020-1-10 <span class="bull">·</span><span id="busuanzi_value_page_pv"></span> 次阅读</p></header></div><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main" role="main"><article id="post-1" class="post-1 post type-post status-publish format-standard has-post-thumbnail hentry category-uncategorized"><div class="toc"></div><div class="entry-content"><pre><code>      Apache Shiro是Java的一个安全框架。Shiro可以帮助我们完成：认证、授权、加密、会话管理、与Web集成、缓存等。其不仅可以用在 JavaSE环境，也可以用在 JavaEE 环境。 </code></pre><p><strong>优点</strong></p><ul><li>易于理解的 Java Security API</li><li>简单的身份认证，支持多种数据源</li><li>对角色的简单的授权，支持细粒度的授权</li><li>不跟任何的框架或者容器捆绑，可以独立运行</li></ul><p><strong>特性</strong></p><p><code>Authentication</code>身份认证/登录，验证用户是不是拥有相应的身份<br><code>Authorization</code>授权，即验证权限，验证某个已认证的用户是否拥有某个权限，即判断用户是否能做事情 <code>SessionManagement</code>会话管理，即用户登录后就是一次会话，在没有退出之前，它的所有信息都在会话中<br><code>Cryptography</code>加密，保护数据的安全性，如密码加密存储到数据库，而不是明文存储<br><code>Caching</code>缓存，比如用户登录后，其用户信息，拥有的角色/权限不必每次去查，提高效率<br><code>Concurrency</code>Shiro支持多线程应用的并发验证，即如在一个线程中开启另一个线程，能把权限自动传播過去</p><p><code>Testing</code>提供测试支持<br><code>RunAs</code>允许一个用户假装为另一个用户（如果他们允许）的身份进行访问<br><code>RememberMe</code>记住我，这是非常常见的功能，即一次登录后，下次再来的话不用登录了</p><p><strong>架構</strong></p><p><code>Subject</code>主体，代表了当前的“用户”，这个用户不一定是一个具体的人，与当前应用交互的任何东西都是Subject，如网络爬虫， 机器人等；即一个抽象概念；所有Subject都绑定到SercurityManager，与Subject的所有交互都会委托给SecurityManager；可以把Subject认为是一个门面；SecurityManager才是实际的执行者<br><code>SecurityManage</code>安全管理器；即所有与安全有关的操作都会与SecurityManager交互；且它管理着所有Subject； 可以看出它是Shiro的核心，它负责与后边介绍的其他组件进行交互<br><code>Realm</code>域，Shiro从Realm获取安全数据（如用户，角色，权限），就是说SecurityManager要验证用户身份， 那么它需要从Realm获取相应的用户进行比较以确定用户身份是否合法；也需要从Realm得到用户相应的角色/权限进行验证用户是否能进行操作；可以有1个或多个Realm，我们一般在应用中都需要实现自己的Realm<br><code>SessionManager</code>如果写过Servlet就应该知道Session的概念，Session需要有人去管理它的生命周期，这个组件就是SessionManager<br><code>SessionDAO</code>DAO大家都用过，数据库访问对象，用于会话的CRUD，比如我们想把Session保存到数据库，那么可以实现自己的SessionDAO，也可以写入缓存，以提高性能<br><code>CacheManager</code>缓存控制器，来管理如用户，角色，权限等的缓存的；因为这些数据基本上很少去改变，放到缓存中后可以提高访问的性能</p><p>应用代码通过Subject来进行认证和授权，而Subject又委托给SecurityManager； 我们需要给Shrio的SecurityManager注入Realm，从而让SecurityManager能得到合法的用户及其权限进行判断，Shiro不提供维护用户/权限，而是通过Realm让开发人员自己注入。</p><p><strong>Shiro不会去维护用户，维护权限；这些需要自己去设计/提供；然后通过响应的接口注入给Shiro即可</strong></p><h4 id="引入依賴"><a href="#引入依賴" class="headerlink" title="引入依賴"></a>引入依賴</h4><pre><code>&lt;!--Shiro核心框架 --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.shiro&lt;/groupId&gt;
            &lt;artifactId&gt;shiro-core&lt;/artifactId&gt;
            &lt;version&gt;${shiro.version}&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;!-- Shiro使用Spring框架 --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.shiro&lt;/groupId&gt;
            &lt;artifactId&gt;shiro-spring&lt;/artifactId&gt;
            &lt;version&gt;${shiro.version}&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;!-- Shiro使用EhCache缓存框架 --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.shiro&lt;/groupId&gt;
            &lt;artifactId&gt;shiro-ehcache&lt;/artifactId&gt;
            &lt;version&gt;${shiro.version}&lt;/version&gt;
        &lt;/dependency&gt;</code></pre><h4 id="权限配置加载"><a href="#权限配置加载" class="headerlink" title="权限配置加载"></a>权限配置加载</h4><pre><code>@Configuration
public class ShiroConfig
{
    public static final String PREMISSION_STRING = &quot;perms[\&quot;{0}\&quot;]&quot;;

    // Session超时时间，单位为毫秒（默认30分钟）
    @Value(&quot;${shiro.session.expireTime}&quot;)
    private int expireTime;

    // 相隔多久检查一次session的有效性，单位毫秒，默认就是10分钟
    @Value(&quot;${shiro.session.validationInterval}&quot;)
    private int validationInterval;

    // 同一个用户最大会话数
    @Value(&quot;${shiro.session.maxSession}&quot;)
    private int maxSession;
    。。。。。。。。。。。。。。。。。。
     /**
     * 缓存管理器 使用Ehcache实现
     */
    @Bean
    public EhCacheManager getEhCacheManager()
    {
        net.sf.ehcache.CacheManager cacheManager = net.sf.ehcache.CacheManager.getCacheManager(&quot;ruoyi&quot;);
        EhCacheManager em = new EhCacheManager();
        if (StringUtils.isNull(cacheManager))
        {
            em.setCacheManager(new net.sf.ehcache.CacheManager(getCacheManagerConfigFileInputStream()));
            return em;
        }
        else
        {
            em.setCacheManager(cacheManager);
            return em;
        }
    }
 /**
     * 自定义Realm
     */
    @Bean
    public UserRealm userRealm(EhCacheManager cacheManager)
    {
        UserRealm userRealm = new UserRealm();
        userRealm.setCacheManager(cacheManager);
        return userRealm;
    }
     /**
     * 自定义sessionDAO会话
     */
    @Bean
    public OnlineSessionDAO sessionDAO()
    {
        OnlineSessionDAO sessionDAO = new OnlineSessionDAO();
        return sessionDAO;
    }
    /**
     * 自定义sessionFactory会话
     */
    @Bean
    public OnlineSessionFactory sessionFactory()
    {
        OnlineSessionFactory sessionFactory = new OnlineSessionFactory();
        return sessionFactory;
    }
    /**
     * 会话管理器
     */
    @Bean
    public OnlineWebSessionManager sessionManager()
    {
        OnlineWebSessionManager manager = new OnlineWebSessionManager();
        // 加入缓存管理器
        manager.setCacheManager(getEhCacheManager());
        // 删除过期的session
        manager.setDeleteInvalidSessions(true);
        // 设置全局session超时时间
        manager.setGlobalSessionTimeout(expireTime * 60 * 1000);
        // 去掉 JSESSIONID
        manager.setSessionIdUrlRewritingEnabled(false);
        // 定义要使用的无效的Session定时调度器
        manager.setSessionValidationScheduler(SpringUtils.getBean(SpringSessionValidationScheduler.class));
        // 是否定时检查session
        manager.setSessionValidationSchedulerEnabled(true);
        // 自定义SessionDao
        manager.setSessionDAO(sessionDAO());
        // 自定义sessionFactory
        manager.setSessionFactory(sessionFactory());
        return manager;
    }
     /**
     * 安全管理器
     */
    @Bean
    public SecurityManager securityManager(UserRealm userRealm)
    {
        DefaultWebSecurityManager securityManager = new DefaultWebSecurityManager();
        // 设置realm.
        securityManager.setRealm(userRealm);
        // 记住我
        securityManager.setRememberMeManager(rememberMeManager());
        // 注入缓存管理器;
        securityManager.setCacheManager(getEhCacheManager());
        // session管理器
        securityManager.setSessionManager(sessionManager());
        return securityManager;
    }
    /**
     * Shiro过滤器配置
     */
    @Bean
    public ShiroFilterFactoryBean shiroFilterFactoryBean(SecurityManager securityManager)
    {
        ShiroFilterFactoryBean shiroFilterFactoryBean = new ShiroFilterFactoryBean();
        // Shiro的核心安全接口,这个属性是必须的
        shiroFilterFactoryBean.setSecurityManager(securityManager);
        // 身份认证失败，则跳转到登录页面的配置
        shiroFilterFactoryBean.setLoginUrl(loginUrl);
        // 权限认证失败，则跳转到指定页面
        shiroFilterFactoryBean.setUnauthorizedUrl(unauthorizedUrl);
        // Shiro连接约束配置，即过滤链的定义
        LinkedHashMap&lt;String, String&gt; filterChainDefinitionMap = new LinkedHashMap&lt;&gt;();
        // 对静态资源设置匿名访问
        filterChainDefinitionMap.put(&quot;/favicon.ico**&quot;, &quot;anon&quot;);
        filterChainDefinitionMap.put(&quot;/ruoyi.png**&quot;, &quot;anon&quot;);
        filterChainDefinitionMap.put(&quot;/css/**&quot;, &quot;anon&quot;);
        filterChainDefinitionMap.put(&quot;/docs/**&quot;, &quot;anon&quot;);
        filterChainDefinitionMap.put(&quot;/fonts/**&quot;, &quot;anon&quot;);
        filterChainDefinitionMap.put(&quot;/img/**&quot;, &quot;anon&quot;);
        filterChainDefinitionMap.put(&quot;/ajax/**&quot;, &quot;anon&quot;);
        filterChainDefinitionMap.put(&quot;/js/**&quot;, &quot;anon&quot;);
        filterChainDefinitionMap.put(&quot;/ruoyi/**&quot;, &quot;anon&quot;);
        filterChainDefinitionMap.put(&quot;/captcha/captchaImage**&quot;, &quot;anon&quot;);
        // 退出 logout地址，shiro去清除session
        filterChainDefinitionMap.put(&quot;/logout&quot;, &quot;logout&quot;);
        // 不需要拦截的访问
        filterChainDefinitionMap.put(&quot;/login&quot;, &quot;anon,captchaValidate&quot;);
        // 系统权限列表
        // filterChainDefinitionMap.putAll(SpringUtils.getBean(IMenuService.class).selectPermsAll());

        Map&lt;String, Filter&gt; filters = new LinkedHashMap&lt;String, Filter&gt;();
        filters.put(&quot;onlineSession&quot;, onlineSessionFilter());
        filters.put(&quot;syncOnlineSession&quot;, syncOnlineSessionFilter());
        filters.put(&quot;captchaValidate&quot;, captchaValidateFilter());
        filters.put(&quot;kickout&quot;, kickoutSessionFilter());
        // 注销成功，则跳转到指定页面
        filters.put(&quot;logout&quot;, logoutFilter());
        shiroFilterFactoryBean.setFilters(filters);

        // 所有请求需要认证
        filterChainDefinitionMap.put(&quot;/**&quot;, &quot;user,kickout,onlineSession,syncOnlineSession&quot;);
        shiroFilterFactoryBean.setFilterChainDefinitionMap(filterChainDefinitionMap);

        return shiroFilterFactoryBean;
    }
     /**
     * 开启Shiro注解通知器
     */
    @Bean
    public AuthorizationAttributeSourceAdvisor authorizationAttributeSourceAdvisor(
            @Qualifier(&quot;securityManager&quot;) SecurityManager securityManager)
    {
        AuthorizationAttributeSourceAdvisor authorizationAttributeSourceAdvisor = new AuthorizationAttributeSourceAdvisor();
        authorizationAttributeSourceAdvisor.setSecurityManager(securityManager);
        return authorizationAttributeSourceAdvisor;
    }</code></pre><h4 id="自定義Realm登錄認證"><a href="#自定義Realm登錄認證" class="headerlink" title="自定義Realm登錄認證"></a>自定義Realm登錄認證</h4><pre><code> public class UserRealm extends AuthorizingRealm
{
    @Override
    protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken token)         throws AuthenticationException
    {
        UsernamePasswordToken upToken = (UsernamePasswordToken) token;
        String username = upToken.getUsername();
        String password = &quot;&quot;;
        if (upToken.getPassword() != null)
        {
            password = new String(upToken.getPassword());
        }

        User user = null;
        try
        {
            user = loginService.login(username, password);
        }</code></pre><h4 id="授權"><a href="#授權" class="headerlink" title="授權"></a>授權</h4><pre><code> protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection arg0)
    {
        User user = ShiroUtils.getSysUser();
        // 角色列表
        Set&lt;String&gt; roles = new HashSet&lt;String&gt;();
        // 功能列表
        Set&lt;String&gt; menus = new HashSet&lt;String&gt;();
        SimpleAuthorizationInfo info = new SimpleAuthorizationInfo();
        // 管理员拥有所有权限
        if (user.isAdmin())
        {
            info.addRole(&quot;admin&quot;);
            info.addStringPermission(&quot;*:*:*&quot;);
        }
        else
        {
            roles = roleService.selectRoleKeys(user.getUserId());
            menus = menuService.selectPermsByUserId(user.getUserId());
            // 角色加入AuthorizationInfo认证对象
            info.setRoles(roles);
            // 权限加入AuthorizationInfo认证对象
            info.setStringPermissions(menus);
        }
        return info;
    }</code></pre></div><div class="single-reward"><div class="reward-open">赏<div class="reward-main"><ul class="reward-row"><li class="alipay-code"><img src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/custom/donate/AliPayQR.jpg"></li><li class="wechat-code"><img src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/custom/donate/WeChanQR.jpg"></li></ul></div></div></div><div style="text-align:center;width:100%" class="social-share share-mobile" data-disabled="diandian, tencent"></div><footer class="post-footer"><div class="post-lincenses"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="nofollow"><i class="fa fa-creative-commons" aria-hidden="true"></i> 知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a></div><div class="post-tags"></div><div class="post-share"><div class="social-share sharehidden share-component"></div><i class="iconfont show-share icon-forward"></i></div></footer></article><div class="toc" style="background:0 0"></div><section class="post-squares nextprev"><div class="post-nepre half previous"><a href="/2020/01/10/hibernate-validator/" rel="prev"><div class="background"><img class="lazyload" src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/anime/22.jpg" style="width:100%;height:100%;object-fit:cover;pointer-events:none" onerror="imgError(this,3)" src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/anime/22.jpg"></div><span class="label">Previous Post</span><div class="info"><h3>Springboot參數校驗hibernate-validator</h3><hr></div></a></div><div class="post-nepre half next"><a href="/2020/01/10/quartz/" rel="next"><div class="background"><img class="lazyload" src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/loader/orange.progress-bar-stripe-loader.svg" data-src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/anime/18.jpg" style="width:100%;height:100%;object-fit:cover;pointer-events:none" onerror="imgError(this,3)" src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/anime/18.jpg"></div><span class="label">Next Post</span><div class="info"><h3>定時任務quartz使用</h3><hr></div></a></div></section><div id="vcomments"></div><script>window.onload=function(){(new Valine).init({el:"#vcomments",appId:"IMM34UkPXXl7Mt5n4RAXaYfH-gzGzoHsz",appKey:"5QWKOyJVR6WOwKDKvKfNsxH8",path:window.location.pathname,placeholder:"你是我一生只会遇见一次的惊喜 ..."})}</script><section class="author-profile"><div class="info" itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="mumudadi.top" class="profile gravatar"><img src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/custom/avatar.jpg" itemprop="image" alt="木木" height="70" width="70"></a><div class="meta"><span class="title">Author</span><h3 itemprop="name"><a href="mumudadi.top" itemprop="url" rel="author">木木</a></h3></div></div><hr><p><i class="iconfont icon-write"></i>一个好奇的人</p></section></main></div></div></div><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" class="ins-search-input" placeholder="请输入关键词..."><span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"文章",CATEGORIES:"分类",TAGS:"标签"},ROOT_URL:"/",CONTENT_URL:"/content.json"}</script><footer id="colophon" class="site-footer" role="contentinfo"><div class="site-info"><div class="footertext"><div class="img-preload"><img src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/other/wordpress-rotating-ball-o.svg"> <img src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/other/disqus-preloader.svg"></div><p style="color:#666">&copy 2020</p></div><div class="footer-device"><p style="font-family:Ubuntu,sans-serif"><span style="color:#b9b9b9">Theme <a href="https://github.com/honjun/hexo-theme-sakura" target="_blank" style="color:#b9b9b9;text-decoration:underline dotted rgba(0,0,0,.1)">Sakura</a><i class="iconfont icon-sakura rotating" style="color:pink;display:inline-block"></i> by <a href="https://2heng.xin/" target="_blank" style="color:#b9b9b9;text-decoration:underline dotted rgba(0,0,0,.1)">Mashiro</a>&<a href="https://www.hojun.cn/" target="_blank" style="color:#b9b9b9;text-decoration:underline dotted rgba(0,0,0,.1)">Hojun</a>, Powered by Hexo, Hosted by Coding Pages</span></p></div></div></footer><script src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/js/lib.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script><script src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/js/InsightSearch.js"></script><script src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/js/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/js/zoom.min.js"></script><script src="/js/sakura-app.js"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine@1.3.4/dist/Valine.min.js"></script><script src="/js/botui.min.js"></script><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent))var Poi={pjax:"1",movies:{url:"https://lc-0OwJ6sYh.cn-e1.lcfile.com/6208c0e6643e7bcf94d0",name:"yunYun_xiaoYan.mp4",live:"close"},windowheight:"fixed",codelamp:"close",ajaxurl:"",order:"asc",formpostion:"bottom"};else Poi={pjax:"1",movies:{url:"https://lc-0OwJ6sYh.cn-e1.lcfile.com/6208c0e6643e7bcf94d0",name:"yunYun_xiaoYan.mp4",live:"open"},windowheight:"auto",codelamp:"close",ajaxurl:"",order:"asc",formpostion:"bottom"}</script><script>$(document).ready(function(){if(0<$(".toc").length&&1200<document.body.clientWidth){0<$(".pattern-center").length?tocbot.init({tocSelector:".toc",contentSelector:".entry-content",scrollSmooth:!0,headingSelector:"h1, h2, h3, h4, h5",headingsOffset:-400,scrollSmoothOffset:-85}):tocbot.init({tocSelector:".toc",contentSelector:".entry-content",scrollSmooth:!0,headingSelector:"h1, h2, h3, h4, h5",headingsOffset:-85,scrollSmoothOffset:-85});var o=$(".toc").offset().top-95;window.onscroll=function(){var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;o<=t?$(".toc").addClass("toc-fixed"):$(".toc").removeClass("toc-fixed")}}})</script><div class="openNav no-select" style="height:50px"><div class="iconflat no-select" style="width:50px;height:50px"><div class="icon"></div></div><div class="site-branding search-form-submit"><i class="iconfont js-toggle-search iconsearch icon-search"></i></div></div></section><div class="skin-menu no-select" id="mainskin" style="position:fixed"><div class="theme-controls row-container"><ul class="menu-list"><li id="white-bg"><i class="fa fa-television" aria-hidden="true"></i></li><li id="sakura-bg"><i class="iconfont icon-sakura"></i></li><li id="gribs-bg"><i class="fa fa-slack" aria-hidden="true"></i></li><li id="KAdots-bg"><i class="iconfont icon-dots"></i></li><li id="totem-bg"><i class="fa fa-optin-monster" aria-hidden="true"></i></li><li id="pixiv-bg"><i class="iconfont icon-pixiv"></i></li><li id="bing-bg"><i class="iconfont icon-bing"></i></li><li id="dark-bg"><i class="fa fa-moon-o" aria-hidden="true"></i></li></ul></div></div><canvas id="night-mode-cover"></canvas><div class="changeSkin-gear no-select"><div class="keys" id="setbtn"><span id="open-skinMenu">切换主题 | SCHEME TOOL<i class="iconfont icon-gear inline-block rotating"></i></span></div></div><div id="mo-nav"><div class="m-avatar"><img src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/img/custom/avatar.jpg"></div><p style="text-align:center;color:#333;font-weight:900;font-family:Ubuntu,sans-serif;letter-spacing:1.5px">さくら荘の木木</p><p style="text-align:center;word-spacing:20px"><a href="https://github.com/mumudadi" class="fa fa-github" target="_blank" style="color:#333;margin-left:20px"></a><a href="https://github.com/mumudadi" class="fa fa-weibo" target="_blank" style="color:#dd4b39;margin-left:20px"></a><a href="https://wpa.qq.com/msgrd?v=3&uin=763261855&site=qq&menu=yes" class="fa fa-qq" target="_blank" style="color:#25c6fe;margin-left:20px"></a></p><ul id="menu-new-1" class="menu"><li><a href="/"><span class="faa-parent animated-hover"><i class="fa fa-fort-awesome faa-shake" aria-hidden="true"></i> 首页</span></a></li><li><a href="/archives"><span class="faa-parent animated-hover"><i class="fa fa-archive faa-shake" aria-hidden="true"></i> 归档</span></a><ul class="sub-menu"><li><a href="/categories/%E6%8A%80%E6%9C%AF/"><i class="fa fa-code" aria-hidden="true"></i> 技术</a></li><li><a href="/categories/%E7%94%9F%E6%B4%BB/"><i class="fa fa-file-text-o" aria-hidden="true"></i> 生活</a></li><li><a href="/categories/%E8%B5%84%E6%BA%90/"><i class="fa fa-cloud-download" aria-hidden="true"></i> 资源</a></li><li><a href="/categories/%E9%9A%8F%E6%83%B3/"><i class="fa fa-commenting-o" aria-hidden="true"></i> 随想</a></li><li><a href="/categories/%E8%BD%AC%E8%BD%BD/"><i class="fa fa-book" aria-hidden="true"></i> 转载</a></li></ul></li><li><a href="javascript:;"><span class="faa-parent animated-hover"><i class="fa fa-list-ul faa-vertical" aria-hidden="true"></i> 清单</span></a><ul class="sub-menu"><li><a href="javascript:location.href+='home/';"><i class="fa fa-fort-awesome" aria-hidden="true"></i> 主页</a></li><li><a href="/backstage/"><i class="fa fa fa-meetup faa-pulse" aria-hidden="true"></i> 后台</a></li><li><a href="/cool/"><i class="fa fa fa-terminal" aria-hidden="true"></i> 炫酷</a></li><li><a href="/tags/%E6%82%A6%E8%AF%BB/"><i class="fa fa-th-list faa-bounce" aria-hidden="true"></i> 书单</a></li><li><a href="/bangumi/"><i class="fa fa-film faa-vertical" aria-hidden="true"></i> 番组</a></li><li><a href="/music/"><i class="fa fa-headphones" aria-hidden="true"></i> 歌单</a></li><li><a href="/tags/%E5%9B%BE%E9%9B%86/"><i class="fa fa-photo" aria-hidden="true"></i> 图集</a></li></ul></li><li><a href="/comment/"><span class="faa-parent animated-hover"><i class="fa fa-pencil-square-o faa-tada" aria-hidden="true"></i> 留言板</span></a></li><li><a href="/links/"><span class="faa-parent animated-hover"><i class="fa fa-link faa-shake" aria-hidden="true"></i> 友人帐</span></a></li><li><a href="/donate/"><span class="faa-parent animated-hover"><i class="fa fa-heart faa-pulse" aria-hidden="true"></i> 赞赏</span></a></li><li><a href="javascript:;"><span class="faa-parent animated-hover"><i class="fa fa-leaf faa-wrench" aria-hidden="true"></i> 关于</span></a><ul class="sub-menu"><li><a href="/about/"><i class="fa fa-meetup" aria-hidden="true"></i> 我？</a></li><li><a href="/theme-sakura/"><i class="fa iconfont icon-sakura" aria-hidden="true"></i> 主题</a></li><li><a href="/lab/"><i class="fa fa-cogs" aria-hidden="true"></i> Lab</a></li></ul></li><li><a href="/client/"><span class="faa-parent animated-hover"><i class="fa fa-android faa-vertical" aria-hidden="true"></i> 客户端</span></a></li><li><a href="/atom.xml"><span class="faa-parent animated-hover"><i class="fa fa-rss faa-pulse" aria-hidden="true"></i> RSS</span></a></li></ul><p style="text-align:center;font-size:13px;color:#b9b9b9">&copy 2020 hexo-sakura</p></div><button onclick="topFunction()" class="mobile-cd-top" id="moblieGoTop" title="Go to top" style="display:none"><i class="fa fa-chevron-up" aria-hidden="true"></i></button><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.bootcss.com/hls.js/8.0.0-beta.3/hls.min.js"></script><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><style>.aplayer .aplayer-lrc{height:35px}.aplayer .aplayer-lrc p{font-size:16px;font-weight:700;line-height:18px!important}.aplayer .aplayer-lrc p.aplayer-lrc-current{color:orange}.aplayer.aplayer-narrow .aplayer-body{left:-66px!important}.aplayer.aplayer-fixed .aplayer-lrc{display:none}.aplayer .aplayer-lrc.aplayer-lrc-hide{display:none!important}.aplayer.aplayer-fixed .lrc-show{display:block;max-width:800px;margin:0 auto;background:rgba(255,255,255,.7)}</style><div id="aplayer"></div><script>$(function(){
    const ap =  new APlayer({
            container: document.getElementById('aplayer'),
            fixed: true,
            lrcType: 3,
            preload: 'auto',
            audio: [
            
              {"name":"Machico - only my railgun","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/20.mp3","cover":"https://p3.music.126.net/umN1L50UDb2V9g3mKm4wbw==/18578447976193381.jpg?param=300y300",
              "lrc":"https://api.i-meto.com/meting/api?server=netease&type=lrc&id=448742120&auth=dcf64eece809ddf6b5fca979076a70d6507d8b4053b03f89f9a4af109968178b"},
             
              {"name":"DEJA VU (EXTENDED MIX)","artist":"Dave Rodgers",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/deja_vu.mp3","cover":"https://p3.music.126.net/ktOuFM8J4DNJYOjW_Fv7WA==/109951164071133774.jpg?param=300y300",
              "lrc":"https://api.i-meto.com/meting/api?server=netease&type=lrc&id=1364973839&auth=cd7817c1cb68db3407099c0fe43f15896a2b9e2387af7221a32687e5fcd66804"},
             
              {"name":"爱殇 - 小时姑娘  龚骏","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/48.mp3","cover":"https://p3.music.126.net/U8gz-goWF6O0KNWxAQN01Q==/109951163870763627.jpg?param=300y300",
              "lrc":"https://api.i-meto.com/meting/api?server=netease&type=lrc&id=1332153723&auth=8029f43866a9673bbaaac828e8ca07cb7d71dde7484c63cc673de5b134fccab7"},
             
              {"name":"让我留在你身边 - Vk","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/Vk.mp3","cover":"https://p3.music.126.net/IwsuD-Ez7KSKYCgsayZOLQ==/17801093254050813.jpg?param=300y300",
              "lrc":"https://api.i-meto.com/meting/api?server=netease&type=lrc&id=454935870&auth=afdcb60e76d663e4ad3e482c199398c3b7b4a6b8ee78d4d10c270b014b164157"},
             
              {"name":"Goose house - 光るなら","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/15.mp3","cover":"https://p3.music.126.net/TM6SM2-ppcd1F66YyjR-Eg==/2537672838610591.jpg?param=300y300",
              "lrc":"https://api.i-meto.com/meting/api?server=netease&type=lrc&id=29732992&auth=6e890d7b89d6f21e681b0ad2d20e78b683f62c8ba4ba760212cc4e9a4b307fd6"},
             
              {"name":"【取经计划·原创】新·九九八十一（官方优化版）","artist":"泠鸢yousa",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/9981.mp3","cover":"https://p3.music.126.net/k8Fxa118GP34K0VTGKWaDg==/109951163003648209.jpg?param=300y300",
              "lrc":"https://api.i-meto.com/meting/api?server=netease&type=lrc&id=498942717&auth=ad9f0b5709e4892b23de9997705e557e3d86dc1a8c837ecacd54011fb2ac19f8"},
             
              {"name":"AZA微唱团-从别后(女声版)-《斗破苍穹》特别篇片尾曲","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/congbiehou.mp3","cover":"",
              "lrc":""},
             
              {"name":"DAOKO、米津玄師 - 打上花火","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/6.mp3","cover":"",
              "lrc":""},
             
              {"name":"泠鸢yousa - 勾指起誓（Cover：ilem）","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/42.mp3","cover":"",
              "lrc":""},
             
              {"name":"泠鸢yousa - 繁华唱遍（泠鸢翻唱版）（Cover：乐正绫 调教：纳兰寻风）","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/43.mp3","cover":"",
              "lrc":""},
             
              {"name":"T-Ara - Day By Day","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/33.mp3","cover":"",
              "lrc":""},
             
              {"name":"T-Ara - Time To Love","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/34.mp3","cover":"",
              "lrc":""},
             
              {"name":"蒋蒋 - 钱女友","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/60.mp3","cover":"",
              "lrc":""},
             
              {"name":"杨梓琪呀+-+去年夏天（Cover：家家）","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/69.mp3","cover":"",
              "lrc":""},
             
              {"name":"很任性","artist":"仟佰顺",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/henrenxing.mp3","cover":"",
              "lrc":""},
             
              {"name":"Basshunter-All_I_Ever_Wanted","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/Basshunter-All_I_Ever_Wanted.mp3","cover":"",
              "lrc":""},
             
              {"name":"Be_My_Babe","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/Be_My_Babe.mp3","cover":"",
              "lrc":""},
             
              {"name":"Befour-How_Do_You_Do","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/Befour-How_Do_You_Do.mp3","cover":"",
              "lrc":""},
             
              {"name":"Beyonce-ladyGaga-Telephone","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/Beyonce-ladyGaga-Telephone.mp3","cover":"",
              "lrc":""},
             
              {"name":"BoA - Masayume Chasing","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/1.mp3","cover":"",
              "lrc":""},
             
              {"name":"Christina Aguilera、maroon 5 - Moves Like Jagger","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/4.mp3","cover":"",
              "lrc":""},
             
              {"name":"Christine+welch+-+一百万个可能","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/5.mp3","cover":"",
              "lrc":""},
             
              {"name":"Dj Bobo - I Love My Radio","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/7.mp3","cover":"",
              "lrc":""},
             
              {"name":"Dr Alban - Chiki Chiki","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/8.mp3","cover":"",
              "lrc":""},
             
              {"name":"Fabrizio E Marco - Fly Away - Radio Edit","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/10.mp3","cover":"",
              "lrc":""},
             
              {"name":"Flying Steps - We Are Electric","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/11.mp3","cover":"",
              "lrc":""},
             
              {"name":"Game of Thrones Medley - 2Cellos","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/13.mp3","cover":"",
              "lrc":""},
             
              {"name":"GARNiDELiA - 極楽浄土","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/14.mp3","cover":"",
              "lrc":""},
             
              {"name":"Justin Bieber - As Long As You Love Me","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/19.mp3","cover":"",
              "lrc":""},
             
              {"name":"Madonna - Celebration","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/21.mp3","cover":"",
              "lrc":""},
             
              {"name":"Mc梦 - 死一样的痛过","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/22.mp3","cover":"",
              "lrc":""},
             
              {"name":"RSP - さくら ~あなたに出会えてよかった~","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/24.mp3","cover":"",
              "lrc":""},
             
              {"name":"Sarina Paris - Just About Enough","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/26.mp3","cover":"",
              "lrc":""},
             
              {"name":"SING女团 - 云裳谣","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/27.mp3","cover":"",
              "lrc":""},
             
              {"name":"T Ara - 为什么这样","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/30.mp3","cover":"",
              "lrc":""},
             
              {"name":"The Wanted - Chasing The Sun","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/35.mp3","cover":"",
              "lrc":""},
             
              {"name":"ワルキューレ - いけないボーダーライン","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/39.mp3","cover":"",
              "lrc":""},
             
              {"name":"徐良、阿悄-坏女孩","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/40.mp3","cover":"",
              "lrc":""},
             
              {"name":"南拳妈妈 - 下雨天","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/41.mp3","cover":"",
              "lrc":""},
             
              {"name":"肥皂菌丨珉珉的猫咪丨 - 将进酒（Cover：佑可猫）","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/44.mp3","cover":"",
              "lrc":""},
             
              {"name":"帝都-萌萌哒天团","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/49.mp3","cover":"",
              "lrc":""},
             
              {"name":"曲婉婷 - 没有什么不同","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/50.mp3","cover":"",
              "lrc":""},
             
              {"name":"千灯愿-Ace组合","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/52.mp3","cover":"",
              "lrc":""},
             
              {"name":"扑蝴蝶-仙剑奇侠传-7729836","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/57.mp3","cover":"",
              "lrc":""},
             
              {"name":"苍浪剑赋-骆集益","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/58.mp3","cover":"",
              "lrc":""},
             
              {"name":"劲乐团 - 樱花月","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/61.mp3","cover":"",
              "lrc":""},
             
              {"name":"境界线上的地平线 Stardust Melodia","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/65.mp3","cover":"",
              "lrc":""},
             
              {"name":"句号 - G.E.M.邓紫棋","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/67.mp3","cover":"",
              "lrc":""},
             
              {"name":"泠鸢yousa 茶理理 Hanser 三无MarBlue - 千里邀月（人声本家）","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/74.MP3","cover":"",
              "lrc":""},
             
              {"name":"眉间雪 (纯歌版)-晴愔","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/77.mp3","cover":"",
              "lrc":""},
             
              {"name":"满汉全席音乐团队 - 樱花樱花想见你","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/78.mp3","cover":"",
              "lrc":""},
             
              {"name":"谢馨哲 - 董小姐","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/79.mp3","cover":"",
              "lrc":""},
             
              {"name":"回梦游仙-骆集益","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/81.mp3","cover":"",
              "lrc":""},
             
              {"name":"仙剑奇侠传 - 仙剑问情","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/86.mp3","cover":"",
              "lrc":""},
             
              {"name":"凤歌青天-骆集益","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/88.mp3","cover":"",
              "lrc":""},
             
              {"name":"银临、云の泣 - 锦鲤抄","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/90.mp3","cover":"",
              "lrc":""},
             
              {"name":"封茗囧菌 - 芊芊","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/95.mp3","cover":"",
              "lrc":""},
             
              {"name":"周杰伦-稻香","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/96.mp3","cover":"",
              "lrc":""},
             
              {"name":"银临 - 不老梦","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/97.mp3","cover":"",
              "lrc":""},
             
              {"name":"杨幂 - 爱的供养","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/99.mp3","cover":"",
              "lrc":""},
             
              {"name":"让我留在你身边 - Vk","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/100.mp3","cover":"",
              "lrc":""},
             
              {"name":"排骨教主 - 月光","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/101.mp3","cover":"",
              "lrc":""},
             
              {"name":"双笙 - 提灯照河山","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/102.mp3","cover":"",
              "lrc":""},
             
              {"name":"桃源恋歌-GARNiDELiA (ガルニデリア)","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/103.mp3","cover":"",
              "lrc":""},
             
              {"name":"杏花弦外雨-CRITTY","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/a1.mp3","cover":"",
              "lrc":""},
             
              {"name":"佑可猫 - 长生","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/a2.mp3","cover":"",
              "lrc":""},
             
              {"name":"郁可唯-青衣遥","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/a3.mp3","cover":"",
              "lrc":""},
             
              {"name":"玉水明沙-骆集益","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/a5.mp3","cover":"",
              "lrc":""},
             
              {"name":"韵逐律-仙剑奇侠传","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/a8.mp3","cover":"",
              "lrc":""},
             
              {"name":"织梦行云-骆集益","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/q3.mp3","cover":"",
              "lrc":""},
             
              {"name":"张碧晨 - 开往早晨的午夜","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/q5.mp3","cover":"",
              "lrc":""},
             
              {"name":"银临 - 棠梨煎雪","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/f1.mp3","cover":"",
              "lrc":""},
             
              {"name":"醉逍遥-王笑文","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/f2.mp3","cover":"",
              "lrc":""},
             
              {"name":"小曲儿 - 上邪","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/f3.mp3","cover":"",
              "lrc":""},
             
              {"name":"小泽正澄 - Attraction","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/f4.mp3","cover":"",
              "lrc":""},
             
              {"name":"徐良、阿悄 - 犯贱","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/f8.mp3","cover":"",
              "lrc":""},
             
              {"name":"银临、Aki阿杰 - 牵丝戏","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/d1.mp3","cover":"",
              "lrc":""},
             
              {"name":"佟娜 - 笑看风云","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/d4.mp3","cover":"",
              "lrc":""},
             
              {"name":"双笙、封茗囧菌 - 霜雪千年","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/d5.mp3","cover":"",
              "lrc":""},
             
              {"name":"仙缘再续-曾志豪","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/d6.mp3","cover":"",
              "lrc":""},
             
              {"name":"少年行-骆集益","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/d7.mp3","cover":"",
              "lrc":""},
             
              {"name":"萧忆情Alex - 不谓侠 —《萧音弥漫》专辑收录曲","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/d0.mp3","cover":"",
              "lrc":""},
             
              {"name":"萧忆情Alex、祖娅纳惜 - 缘分一道桥","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/z1.mp3","cover":"",
              "lrc":""},
             
              {"name":"银临 - 泸沽寻梦","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/z2.mp3","cover":"",
              "lrc":""},
             
              {"name":"银临 - 腐草为萤","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/z3.mp3","cover":"",
              "lrc":""},
             
              {"name":"银临、小曲儿 - 天若灵犀","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/z4.mp3","cover":"",
              "lrc":""},
             
              {"name":"西瓜JUN - 长生诀","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/z5.mp3","cover":"",
              "lrc":""},
             
              {"name":"苍浪剑赋-骆集益","artist":"",
              "url":"https://cdn.jsdelivr.net/gh/mumudadi/music@latest/music/z8.mp3","cover":"",
              "lrc":""},
             
            ]
        });
       /* $(".aplayer.aplayer-narrow .aplayer-body").mouseenter(function(){
            $(this).animate({left:'0px'},"fast");
        });
        $(".aplayer.aplayer-narrow .aplayer-body").mouseleave(function(){
            $(this).animate({left:'-66px'},"fast");
        });   */

    $('body').on('click', '.aplayer', function(){
      if($('.aplayer-button').hasClass('aplayer-play')) {
        $('.aplayer-lrc').removeClass('lrc-show');
      } else {
        $('.aplayer-lrc').addClass('lrc-show');
      }
    })


    console.info('\n %c为什么控制台一直在报错呢？QAQ \n','background: #efefef;padding:7px 0 5px;border-radius:0 .5rem .5rem 0;');

  });</script><script>var windowWidth=$(window).width();768<windowWidth&&document.write('<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/mumudadi/cdn@latest/js/sakura.min.js"><\/script>')</script><script>var xlm_wid="15547",xlm_url="https://www.xianliao.me/"</script><script charset="UTF-8" src="https://www.xianliao.me/embed.js"></script><script>!function(e,r,t){var o,n=[];e.requestAnimationFrame=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(e){setTimeout(e,1e3/60)},function(t){var a=r.createElement("style");a.type="text/css";try{a.appendChild(r.createTextNode(t))}catch(e){a.styleSheet.cssText=t}r.getElementsByTagName("head")[0].appendChild(a)}(".heart{width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);}.heart:after,.heart:before{content: '';width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: fixed;}.heart:after{top: -5px;}.heart:before{left: -5px;}"),o="function"==typeof e.onclick&&e.onclick,e.onclick=function(e){var t,a;o&&o(),t=e,(a=r.createElement("div")).className="heart",n.push({el:a,x:t.clientX-5,y:t.clientY-5,scale:1,alpha:1,color:"rgb("+~~(255*Math.random())+","+~~(255*Math.random())+","+~~(255*Math.random())+")"}),r.body.appendChild(a)},function e(){for(var t=0;t<n.length;t++)n[t].alpha<=0?(r.body.removeChild(n[t].el),n.splice(t,1)):(n[t].y--,n[t].scale+=.004,n[t].alpha-=.013,n[t].el.style.cssText="left:"+n[t].x+"px;top:"+n[t].y+"px;opacity:"+n[t].alpha+";transform:scale("+n[t].scale+","+n[t].scale+") rotate(45deg);background:"+n[t].color+";z-index:99999");requestAnimationFrame(e)}()}(window,document)</script><div id="spig" class="spig"><div id="message"></div><div id="xiaomai"></div></div><div class="fixed-xm"><img src="https://cdn.jsdelivr.net/gh/mumudadi/live2dw@latest/xiaomai/xm.png"><audio src="https://cdn.jsdelivr.net/gh/mumudadi/live2dw@latest/xiaomai/xm.mp3" id="xm_audio" preload="auto" style="display:none"></audio></div><div class="fixed-btn"><a class="btn-gotop" href="javascript:"><i class="fa fa-angle-up"></i></a></div><link rel="stylesheet" href="/live2d/css/xiaomai.css"><script src="/live2d/js/xiaomai.js"></script><script src="/live2d/autoload.js?v=1.4.2"></script></body></html>